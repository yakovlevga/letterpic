{"version":3,"file":"letterpic.js","sources":["../src/defaults.ts","../src/providers/helpers.ts","../src/providers/bgProviderColor.ts","../src/providers/bgProviderGradient.ts","../src/letterpic.ts"],"sourcesContent":["import { LetterPicSettings } from 'types/core';\r\n\r\nexport const LETTER_PIC_DEFAULTS: LetterPicSettings = {\r\n  fill: 'gradient',\r\n  size: 100,\r\n  font: 'Arial',\r\n  fontColor: '#fff',\r\n  fontStrokeColor: '#000',\r\n  fontSize: 0.45,\r\n  imageOverlayColor: 'rgba(0, 0, 0, 0)',\r\n  maxInitialsLength: 2,\r\n  // if it's true, it uses global cache for different calls\r\n  useGlobalCache: true,\r\n  // set default images\r\n  images: [],\r\n};\r\n\r\nconst defaultImgPath = 'patterns';\r\nconst defaultImgCount = 8;\r\nconst defaultImgExt = '.png';\r\nfor (let i = 1; i <= defaultImgCount; i++) {\r\n  LETTER_PIC_DEFAULTS.images.push(defaultImgPath + '/' + i + defaultImgExt);\r\n}\r\n","import { LetterPickFontSettings, LetterPicSettings } from 'types/core';\r\n\r\nconst CANVAS_CONTEXT_SCALE = window.devicePixelRatio;\r\n\r\nconst defaultColors = [\r\n  '#1abc9c',\r\n  '#2ecc71',\r\n  '#3498db',\r\n  '#9b59b6',\r\n  '#34495e',\r\n  '#16a085',\r\n  '#27ae60',\r\n  '#2980b9',\r\n  '#8e44ad',\r\n  '#2c3e50',\r\n  '#f1c40f',\r\n  '#e67e22',\r\n  '#e74c3c',\r\n  '#ecf0f1',\r\n  '#95a5a6',\r\n  '#f39c12',\r\n  '#d35400',\r\n  '#c0392b',\r\n  '#bdc3c7',\r\n  '#7f8c8d',\r\n];\r\n\r\nexport const drawText = (\r\n  context: CanvasRenderingContext2D,\r\n  settings: LetterPickFontSettings,\r\n  text: string\r\n) => {\r\n  const { width, height } = context.canvas;\r\n  var fontSize = width * settings.fontSize;\r\n  context.font = `${fontSize}px ${settings.font}`;\r\n  context.textAlign = 'center';\r\n\r\n  var posX = width / 2;\r\n  var posY = (fontSize + height) * 0.45;\r\n\r\n  if (settings.fontStrokeColor) {\r\n    context.shadowColor = settings.fontStrokeColor;\r\n    context.shadowColor = 'black';\r\n    context.shadowOffsetX = 0;\r\n    context.shadowOffsetY = 0;\r\n    context.shadowBlur = 3;\r\n  }\r\n\r\n  context.fillStyle = settings.fontColor;\r\n  context.fillText(text, posX, posY);\r\n};\r\n\r\nexport const getCanvasContextScaled = (\r\n  htmlCanvas: HTMLCanvasElement\r\n): CanvasRenderingContext2D => {\r\n  var context = htmlCanvas.getContext('2d')!;\r\n  var scale = CANVAS_CONTEXT_SCALE;\r\n  context.scale(scale, scale);\r\n  return context;\r\n};\r\n\r\nexport const scaleCanvasContext = (htmlCanvas: HTMLCanvasElement) => {\r\n  var scale = CANVAS_CONTEXT_SCALE;\r\n  htmlCanvas.width = scale * htmlCanvas.width;\r\n  htmlCanvas.height = scale * htmlCanvas.height;\r\n};\r\n\r\nexport const getPreparedCanvasContext = (\r\n  settings: LetterPicSettings\r\n): CanvasRenderingContext2D => {\r\n  const canvas = document.createElement('canvas');\r\n  canvas.width = settings.size;\r\n  canvas.height = settings.size;\r\n  scaleCanvasContext(canvas);\r\n  return getCanvasContextScaled(canvas);\r\n};\r\n\r\nexport const getInitials = (text: string) => {\r\n  var splitted = text.split(' ');\r\n  var result = splitted[0].charAt(0).toUpperCase();\r\n  for (var i = 1; i < 2; i++) {\r\n    if (splitted.length > i) {\r\n      result += splitted[i].charAt(0).toUpperCase();\r\n    }\r\n  }\r\n\r\n  return result;\r\n};\r\n\r\nconst hashCode = (s: string): number => {\r\n  var hash = 0,\r\n    i,\r\n    chr;\r\n  for (i = 0; i < s.length; i++) {\r\n    chr = s.charCodeAt(i);\r\n    hash = (hash << 5) - hash + chr;\r\n    hash |= 0; // Convert to 32bit integer\r\n  }\r\n\r\n  return hash;\r\n};\r\n\r\nexport const getItemByString = <T>(s: string, arr: T[]): T => {\r\n  const idx = Math.abs(hashCode(s)) % arr.length;\r\n  return arr[idx];\r\n};\r\n\r\nexport const getColorByString = (settings: LetterPicSettings, s: string) => {\r\n  const colors = settings.colors || defaultColors;\r\n  return getItemByString(s, colors);\r\n};\r\n\r\nexport const getOrSetBackground = (\r\n  cacheKey: string,\r\n  getBackground: () => CanvasRenderingContext2D['fillStyle']\r\n): CanvasRenderingContext2D['fillStyle'] => {\r\n  const { backgrounds } = window.LetterPicCache;\r\n  if (backgrounds[cacheKey] === undefined) {\r\n    backgrounds[cacheKey] = getBackground();\r\n  }\r\n  return window.LetterPicCache.backgrounds[cacheKey]!;\r\n};\r\n\r\n// export const getBackground = (fill: LetterPicFillType, text: string) => {\r\n//   var bg;\r\n//   if (!self.cache[fill]) {\r\n//     self.cache[fill] = {};\r\n//   }\r\n//   if (!self.cache[fill][key]) {\r\n//     if (bgs.length === 0) bgs = provider.bgs.slice().reverse();\r\n//     bg = bgs.pop();\r\n//     self.cache[fill][key] = bg;\r\n//   } else {\r\n//     bg = self.cache[fill][key];\r\n//   }\r\n//   return bg;\r\n// };\r\n","import {\r\n  drawText,\r\n  getColorByString,\r\n  getOrSetBackground,\r\n  getPreparedCanvasContext,\r\n} from 'providers/helpers';\r\nimport { LetterPicProvider, LetterPicSettings } from 'types/core';\r\n\r\nexport const bgProviderColor: LetterPicProvider = (\r\n  settings: LetterPicSettings\r\n) => {\r\n  const context = getPreparedCanvasContext(settings);\r\n\r\n  const draw = (text: string, cacheKey: string) => {\r\n    context.fillStyle = getOrSetBackground(cacheKey, () =>\r\n      getColorByString(settings, cacheKey)\r\n    );\r\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\r\n    drawText(context, settings, text);\r\n    return context.canvas;\r\n  };\r\n\r\n  return { draw };\r\n};\r\n","import {\r\n  drawText,\r\n  getColorByString,\r\n  getItemByString,\r\n  getOrSetBackground,\r\n  getPreparedCanvasContext,\r\n} from 'providers/helpers';\r\nimport type {\r\n  LetterPicGradient,\r\n  LetterPicProvider,\r\n  LetterPicSettings,\r\n} from 'types/core';\r\n\r\nconst getLinearGradient = (\r\n  context: CanvasRenderingContext2D,\r\n  colors: LetterPicGradient\r\n): CanvasGradient => {\r\n  const gradient = context.createLinearGradient(0, 0, 0, context.canvas.height);\r\n  gradient.addColorStop(0, colors[0]);\r\n  var gradientStep = 1 / (colors.length - 1);\r\n  for (var i = 1; i < colors.length - 1; i++) {\r\n    gradient.addColorStop(i * gradientStep, colors[i]);\r\n  }\r\n  gradient.addColorStop(1, colors[colors.length - 1]);\r\n  return gradient;\r\n};\r\n\r\nconst reverseString = (s: string) => s.split('').reverse().join('');\r\n\r\nexport const bgProviderGradient: LetterPicProvider = (\r\n  settings: LetterPicSettings\r\n) => {\r\n  const context = getPreparedCanvasContext(settings);\r\n\r\n  const draw = (text: string, cacheKey: string) => {\r\n    context.fillStyle = getOrSetBackground(cacheKey, () => {\r\n      if (settings.gradients !== undefined && settings.gradients.length > 0) {\r\n        const gradient = getItemByString(cacheKey, settings.gradients);\r\n        return getLinearGradient(context, gradient);\r\n      }\r\n\r\n      const startColor = getColorByString(settings, cacheKey);\r\n      const endColor = getColorByString(settings, reverseString(cacheKey));\r\n\r\n      return getLinearGradient(context, [startColor, endColor]);\r\n    });\r\n\r\n    context.fillRect(0, 0, context.canvas.width, context.canvas.height);\r\n    drawText(context, settings, text);\r\n    return context.canvas;\r\n  };\r\n\r\n  return {\r\n    draw,\r\n  };\r\n};\r\n","import {\r\n  LetterPicProvider,\r\n  LetterPicFillType,\r\n  LetterPicSettings,\r\n} from 'types/core';\r\nimport { LETTER_PIC_DEFAULTS } from 'defaults';\r\nimport { bgProviderColor } from 'providers/bgProviderColor';\r\nimport { bgProviderGradient } from 'providers/bgProviderGradient';\r\n// import { bgProviderImage } from 'providers/bgProviderImage.ts1';\r\nimport { getInitials } from 'providers/helpers';\r\n\r\nconst PROVIDERS: Record<LetterPicFillType, LetterPicProvider> = {\r\n  color: bgProviderColor,\r\n  gradient: bgProviderGradient,\r\n  image: bgProviderColor,\r\n  // image: bgProviderImage,\r\n};\r\n\r\nconst initGlobals = () => {\r\n  if (!window.LetterPicCache) {\r\n    window.LetterPicCache = window.LetterPicCache || {\r\n      backgrounds: {},\r\n    };\r\n  }\r\n};\r\n\r\nexport const letterpic = (userSettings?: Partial<LetterPicSettings>) => {\r\n  initGlobals();\r\n\r\n  const settings: LetterPicSettings = {\r\n    ...userSettings,\r\n    ...LETTER_PIC_DEFAULTS,\r\n    fill: getFillTypeFromSettings(userSettings),\r\n  };\r\n\r\n  const provider = PROVIDERS[settings.fill](settings);\r\n\r\n  const asDataString = (text: string) => {\r\n    const initials = getInitials(text);\r\n    return provider.draw(initials, text).toDataURL();\r\n  };\r\n\r\n  const asImage = (text: string) => {\r\n    const img = document.createElement('img');\r\n    img.src = asDataString(text);\r\n    return img;\r\n  };\r\n\r\n  return { asDataString, asImage };\r\n  // TODO\r\n  // if (self.settings.initial) {\r\n  //   for (var fill in self.settings.initial) {\r\n  //     if (!self.cache[fill]) self.cache[fill] = {};\r\n  //     var bgs = self.settings.initial[fill];\r\n  //     for (var key in bgs) {\r\n  //       self.cache[fill][key] = bgs[key];\r\n  //     }\r\n  //   }\r\n  // }\r\n  // self.drawProvider = self.drawProviders[self.settings.fill](self.settings);\r\n};\r\n\r\nfunction getFillTypeFromSettings(\r\n  userSettings?: Partial<LetterPicSettings>\r\n): LetterPicFillType {\r\n  if (userSettings?.fill !== undefined) {\r\n    return userSettings?.fill;\r\n  } else if (userSettings?.colors !== undefined) {\r\n    return 'color';\r\n  } else if (userSettings?.gradients !== undefined) {\r\n    return 'gradient';\r\n  } else if (userSettings?.images !== undefined) {\r\n    return 'image';\r\n  }\r\n\r\n  return LETTER_PIC_DEFAULTS.fill;\r\n}\r\n\r\n// $.fn.letterpic = function (options) {\r\n//     var self = this;\r\n//     self.$letterpics = [];\r\n//     self.options = options || {};\r\n\r\n//     var lp = new LetterPic(options);\r\n\r\n//     this.each(function () {\r\n//         var $el = $(this);\r\n\r\n//         if ($el.is(\"img\")) {\r\n//             if (!isImageOk($el[0])) {\r\n//                 var $canvas = replaceWithCanvas($el);\r\n//                 if(self.options.onImageError) {\r\n//                     self.options.onImageError($canvas, $el.attr('src'));\r\n//                 }\r\n//             }\r\n//             else {\r\n//                 $el.on(\"error\", onImageError);\r\n//             }\r\n//         }\r\n//         else {\r\n//             replaceWithCanvas($el);\r\n//         }\r\n//     });\r\n\r\n//     function getKey($el) {\r\n//         var key =\r\n//             $el.data().letterpicKey ||\r\n//             $el.data().letterpicUserId ||\r\n//             $el.data().userid ||\r\n//             getInitials($el);\r\n\r\n//         return key;\r\n//     }\r\n\r\n//     function getInitials($el) {\r\n//         var name = $el.attr(\"title\");\r\n\r\n//         var splitted = name.split(\" \");\r\n//         var result = splitted[0].charAt(0).toUpperCase();\r\n//         for(var i = 1; i < lp.settings.maxInitialsLength; i++) {\r\n//             if (splitted.length > i) {\r\n//                 result += splitted[i].charAt(0).toUpperCase();\r\n//             }\r\n//         }\r\n\r\n//         return result;\r\n//     }\r\n\r\n//     function isImageOk(img) {\r\n//         if (!img.complete || (typeof img.naturalWidth !== \"undefined\" && img.naturalWidth === 0)) {\r\n//             return false;\r\n//         }\r\n//         return true;\r\n//     }\r\n\r\n//     function onImageError(event) {\r\n//         var $img = $(event.target);\r\n//         $img.off(\"error\", onImageError);\r\n//         replaceWithCanvas($img, true);\r\n\r\n//         if(self.options.onImageError) {\r\n//             self.options.onImageError($canvas, $img.attr('src'));\r\n//         }\r\n//     }\r\n\r\n//     function replaceWithCanvas($el, isBrokenImage) {\r\n//         var $canvas;\r\n//         if ($el.is(\"canvas\")) {\r\n//             $canvas = $el;\r\n//         }\r\n//         else {\r\n//             $canvas = $(\"<canvas></canvas>\");\r\n//             $.each($el[0].attributes, function (i, attribute) {\r\n//                 $canvas.attr(attribute.name, attribute.value);\r\n//             });\r\n//             $el.replaceWith($canvas);\r\n//         }\r\n\r\n//         var key = getKey($canvas);\r\n//         var text = getInitials($canvas);\r\n//         lp.drawProvider.draw($canvas, key, text);\r\n\r\n//         self.$letterpics.push($canvas);\r\n\r\n//         if(self.options.onElementReplaced) {\r\n//             isBrokenImage = isBrokenImage || false;\r\n//             self.options.onElementReplaced($canvas, isBrokenImage);\r\n//         }\r\n\r\n//         return $canvas;\r\n//     }\r\n\r\n//     return $($.map(self.$letterpics, function($el){\r\n//         return $el.get();\r\n//     }));;\r\n// };\r\n"],"names":[],"mappings":"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"}